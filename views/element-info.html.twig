{% twig_js name="biopen_twigJs_elementInfo" %}

{# -------------- #}
{#  ELEMENT INFO  #}
{# -------------- #}
<li id="element-info-{{ element.id }}" 
    class="element-item" 
    data-element-id="{{ element.id }}">

  {# HEADER #}
  <div class="collapsible-header bgdSoftColorAs {{pendingClass}}" option-id={{mainOptionValueToDisplay.colorOptionId}}>
    
    {# Header Title #}
    <div class='collapsible-header-title row'> 


      <span class="col s12 name">

      {% set mainIcon = element.isPending() ? 'icon-attention' : mainOptionValueToDisplay.option.icon %}
        {# Icons #}
        <span class="element-main-icon icon {{ mainIcon }} colorAs {{pendingClass}} hideOnLargeScreen" option-id={{mainOptionValueToDisplay.colorOptionId}}></span>
        <span class="star-names-icons">
          {% for starName in starNames %} 
              <span class="icon icon-{{starName}}"></span>
            {% endfor %}
        </span>   
           
        {# Distance and Close Button #}
        <span class="icon icon-close" id="btn-close-bandeau-detail"></span>
        {% if showDistance and element.distance != null %}
          <span class="right-align distance">~ {{ element.distance }} km</span>
        {% endif %}

        {# Name #}
        {{ element.getProperty('name')|raw }}
        {{ element.isDeleted ? ' </br><u>(En cours de suppression)</u>' : '' }}
 
      </span>
      <span id="testDiff"></span>
      
    </div>

    {# Header More #}
    <div class='collapsible-header-more row'>

      {# Description #}
      <span class="description col s12">{{ element.getProperty('description')|raw }}</span> 

      {# Categories litteral #}
      <span class="inline-option-values col s8 hideOnLargeScreen">
        {#} {% set isDisabled = mainOptionValueToDisplay.isFilledByFilters ? '' : 'disabled' %}
        <span class="option-value {{ isDisabled }}">{{ mainOptionValueToDisplay.option.name|capitalize }} 
        {% if otherOptionsValuesToDisplay.length != 0 %}, {% endif %}</span>#}

        {% for optionValue in allOptionsValues %} 
            {% set isDisabled = optionValue.isFilledByFilters ? '' : 'disabled' %}
            <span class="option-value {{ isDisabled }}">{{ optionValue.option.name|capitalize }} {% if not loop.last %}, {% endif %}</span>            
        {% endfor %}

      </span>      

      {# Select as Representant (constellation mode) #}
      <span class="col s4 right-align btn-select-as-representant-container" style="display:none">
        <button class="btn btn-select-as-representant waves-effect waves-light" >Sélectionner</button> 
      </span>

      {# Representant Label(constellation mode) #}
      <span class="col s4 right-align starRespresentantLabel" style="display:none">Element principal</span>

      {# Toggle Details Buttons #}
      <a><span class="col s4 right-align moreInfos hideOnLargeScreen">Plus d'infos</span></a>
      <a><span class="col s4 right-align lessInfos hideOnLargeScreen" style="display:none">Moins d'infos</span></a>

    </div>

    {% if not listingMode %}
    <div class="interactive-section">  
      {% if element.isPending() %}
      <div class="vote-section">
        <span class="basic-message">
          <span class="icon-attention"></span>
          <span class="text">{{ element.status == 0 ? 'Nouvel Acteur' : 'Modifications' }} en cours de validation</span>
          <span class="btn-vote-more-info validation-process-info" onclick='$("#popup-vote").openModal()'>EN SAVOIR PLUS</span>
          <span class="vote-button btn btn-vote waves-effect waves-light">Voter</span>
        </span>        
      </div>
      {% endif %}
      <div class="result-message" style="display:none"></div>
    </div>
    {% endif %}

  </div>

  {# BODY #}
  <div class="collapsible-body moreDetails custom-scroll-bar"> 
  
    {# Menu in listing mode #}
    {% if listingMode %}
      <div class="interactive-section">  
        {% if element.isPending() %}
        <div class="vote-section">
          <span class="basic-message">
            <span class="icon-attention"></span>
            <span class="text">Acteur en cours de validation </span>
            <span class="btn-vote-more-info validation-process-info" onclick='$("#popup-vote").openModal()'>EN SAVOIR PLUS</span>
            <span class="vote-button btn btn-vote waves-effect waves-light">Voter</span>
          </span>        
        </div>
        {% endif %}
        <div class="result-message" style="display:none"></div>
      </div>
      {#
        WARNING
        If you modify this menu-element, please report changes in element-menu.html.twig also.
        this is a lack of feature in TwigJsTemplate who does not implements the twig "include" method
      #}
      <div class="menu-element bgdSoftColorAs {{pendingClass}}" option-id={{mainOptionValueToDisplay.colorOptionId}}>  

        <div class="menu-element-item item-add-favorite" style="display:none">
          <span class="menu-icon icon-star-empty icon-favorite tooltipped" 
          data-position="top" data-delay="0" data-tooltip="Enregistrer comme favoris"></span>
          <span class="menu-element-item-text">Enregistrer</span>
        </div>
        <div class="menu-element-item item-remove-favorite" style="display:none">
          <span class="menu-icon icon-star-full icon-favorite tooltipped"
          data-position="top" data-delay="0" data-tooltip="Retirer des favoris"></span>
          <span class="menu-element-item-text favorite">Enregistré</span>
        </div>
        <div class="menu-element-item item-share">
          <span class="menu-icon icon-share-alt tooltipped"
          data-position="top" data-delay="0" data-tooltip="Partager l'URL"></span>
          <span class="menu-element-item-text">Partager l'URL</span>
        </div>
        <div class="menu-element-item item-directions">
          <span class="menu-icon icon-directions tooltipped" 
          data-position="top" data-delay="0" data-tooltip="Itinéraire vers cet élément"></span>
          <span class="menu-element-item-text">Itinéraire</span>
        </div>
        {% if not element.isPending() or isAdmin %}
        <div class="menu-element-item item-edit">
          {% set editText = isAdmin ? 'Modifier' : 'Proposer des modifications' %}
          <span class="menu-icon icon-edit tooltipped" 
          data-position="top" data-delay="0" data-tooltip="{{ editText }}"></span>
          <span class="menu-element-item-text">{{ editText }}</span>
        </div>
        
        <div class="menu-element-item item-delete"> 
          {% set deleteText = isAdmin ? 'Supprimer' : 'Signaler une erreur' %}
          {% set deleteIcon = isAdmin ? 'icon-delete' : 'icon-exclamation-1' %}
          <span class="menu-icon btn-delete {{ deleteIcon }} tooltipped" 
          data-position="top" data-delay="0" data-tooltip="{{ deleteText }}"></span>
          <span class="menu-element-item-text">{{ deleteText }}</span>
        </div>  
        {% endif %}
            
      </div> 
    {% endif %}
  
    {# Body Main Container #}
    <div class="collapsible-body-main-content"> 

      {# Contact infos #}
      <h3>Infos</h3>   
      <div class="section row sectionInfos">

        {# Address #}
        <span class="col s12 address">{{ element.getProperty('address')|raw }}</span>
        
        {# Tel #}
        {% if element.tel %}
          <span class="col s12 tel">{{ element.getProperty('tel')|raw }}</span>
        {% endif %}

        {# Mail #}
        {% if element.mail %}
          <span class="col s12 tel"><a href="mailto:{{ element.mail }}">{{  element.getProperty('mail')|raw }}</a>
          </span>
        {% endif %}

        {# WebSite #}
        {% if element.webSite %}
          <span class="col s12 tel"><a href="{{ element.webSite }}" target="_blank">{{ element.getProperty('webSite')|raw }}</a>
          </span>
        {% endif %}

      </div>
      <div class="divider"></div>
      
      {# Categories  #}
      <h3>Les catégories</h3> 
      <div class="section row categories">
        
        {% include '@directory/directory/twig-js-templates/element-info-category-value.html.twig' with { 'categoryValue' : mainCategoryValue, 'subcategoriesCount' : 1 } %}  

      </div>
      <div class="divider"></div>

      {# Open Hours #}
      <h3>Horaires d'ouverture</h3>   
      <div class="section row sectionOpenHourss">  
        {% set count = 0 %} 

        {% for key, horaire in element.getFormatedOpenHours() %} 
          {% if horaire != null %}

            <div class='row'>
              <span class="col s3 day">{{ key|capitalize }}</span>
              <span class="col s9 openHours">{{ horaire }} </span>
            </div>
            {% set count = count + 1 %} 

          {% endif %}
        {% endfor %}          

        {% if element.openHoursMoreInfos %}
          <div class='col' {% if count != 0 %}style="margin-top:1rem;"{% endif %}>{{ element.getProperty('openHoursMoreInfos')|raw }}</div> 
          {% set count = count + 1 %} 
        {% endif %}

        {% if count == 0 %}<div class='col'> Non renseignées </div>{% endif %} 
      
      </div> 

    </div>
  </div>
</li>

